version: "3.7"
services:
  dev-users:
    restart: always
    image: pabloszx/learner-model-gql
    ports:
      - 3002:3002
    environment:
      DATABASE_URL: ${DATABASE_URL}
      AUTH0_DOMAIN: ${AUTH0_DOMAIN}
      AUTH0_CLIENT: ${AUTH0_CLIENT}
      AUTH0_SECRET: ${AUTH0_SECRET}
    command: pnpm -r start --filter=service-users
  dev-actions:
    restart: always
    image: pabloszx/learner-model-gql
    ports:
      - 3003:3003
    environment:
      DATABASE_URL: ${DATABASE_URL}
      AUTH0_DOMAIN: ${AUTH0_DOMAIN}
      AUTH0_CLIENT: ${AUTH0_CLIENT}
      AUTH0_SECRET: ${AUTH0_SECRET}
    command: pnpm -r start --filter=service-actions
  dev-content:
    restart: always
    image: pabloszx/learner-model-gql
    ports:
      - 3004:3004
    environment:
      DATABASE_URL: ${DATABASE_URL}
      AUTH0_DOMAIN: ${AUTH0_DOMAIN}
      AUTH0_CLIENT: ${AUTH0_CLIENT}
      AUTH0_SECRET: ${AUTH0_SECRET}
    command: pnpm -r start --filter=service-content
  dev-domain:
    restart: always
    image: pabloszx/learner-model-gql
    ports:
      - 3005:3005
    environment:
      DATABASE_URL: ${DATABASE_URL}
      AUTH0_DOMAIN: ${AUTH0_DOMAIN}
      AUTH0_CLIENT: ${AUTH0_CLIENT}
      AUTH0_SECRET: ${AUTH0_SECRET}
    command: pnpm -r start --filter=service-domain
  dev-projects:
    restart: always
    image: pabloszx/learner-model-gql
    ports:
      - 3006:3006
    environment:
      DATABASE_URL: ${DATABASE_URL}
      AUTH0_DOMAIN: ${AUTH0_DOMAIN}
      AUTH0_CLIENT: ${AUTH0_CLIENT}
      AUTH0_SECRET: ${AUTH0_SECRET}
    command: pnpm -r start --filter=service-projects
  dev-state:
    restart: always
    image: pabloszx/learner-model-gql
    ports:
      - 3007:3007
    environment:
      DATABASE_URL: ${DATABASE_URL}
      AUTH0_DOMAIN: ${AUTH0_DOMAIN}
      AUTH0_CLIENT: ${AUTH0_CLIENT}
      AUTH0_SECRET: ${AUTH0_SECRET}
    command: pnpm -r start --filter=service-state
  dev-gateway:
    restart: always
    build:
      dockerfile: Dockerfile.dev
      context: .
    image: pabloszx/learner-model-gql
    network_mode: host
    environment:
      DATABASE_URL: ${DATABASE_URL}
      AUTH0_DOMAIN: ${AUTH0_DOMAIN}
      AUTH0_CLIENT: ${AUTH0_CLIENT}
      AUTH0_SECRET: ${AUTH0_SECRET}
    command: pnpm -r start --filter=gateway
